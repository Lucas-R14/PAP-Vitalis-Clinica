<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editar Funcionário</title>
    <link rel="stylesheet" href="../CSS/editar_funcionario.css">
    <!-- Flatpickr CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Editar Funcionário</h1>
            <nav>
                <a class="btn-voltar" href="gerir_funcionarios.php">Voltar</a>
            </nav>
        </header>

        <main>
            <?php if ($atualizacao_sucesso): ?>
                <!-- Mensagem de sucesso -->
                <div class="mensagem-sucesso">
                    <p>Funcionário atualizado com sucesso!</p>
                    <p>Redirecionando para a página de gerir funcionários...</p>
                </div>

                <!-- Redirecionamento após 2 segundos -->
                <script src="../JS/editar_funcionario.js"></script>

            <?php else: ?>
                <!-- Formulário de edição -->
                <h2>Editar Informações do Funcionário</h2>

                <form method="POST" action="editar_funcionario.php?id=<?php echo $id_funcionario; ?>">
                    <div class="form-group">
                        <label for="nome">Nome:</label>
                        <input type="text" id="nome" name="nome" value="<?php echo $funcionario['nome']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="nif">NIF:</label>
                        <input type="text" id="nif" name="nif" value="<?php echo $funcionario['nif']; ?>" required maxlength="9">
                    </div>

                    <div class="form-group">
                        <label for="cc">Cartão de Cidadão:</label>
                        <input type="text" id="cc" name="cc" value="<?php echo $funcionario['cc']; ?>" required maxlength="12">
                    </div>

                    <div class="form-group">
                        <label for="data_nascimento">Data de Nascimento:</label>
                        <input type="text" id="data_nascimento" name="data_nascimento" placeholder="Selecione a data" value="<?php echo $funcionario['data_nascimento']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="sexo">Sexo:</label>
                        <select id="sexo" name="sexo" required>
                            <option value="Masculino" <?php echo $funcionario['sexo'] === 'Masculino' ? 'selected' : ''; ?>>Masculino</option>
                            <option value="Feminino" <?php echo $funcionario['sexo'] === 'Feminino' ? 'selected' : ''; ?>>Feminino</option>
                            <option value="Outro" <?php echo $funcionario['sexo'] === 'Outro' ? 'selected' : ''; ?>>Outro</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="telefone">Telefone:</label>
                        <input type="text" id="telefone" name="telefone" value="<?php echo $funcionario['telefone']; ?>" required maxlength="15">
                    </div>

                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" name="email" value="<?php echo $funcionario['email']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="endereco">Endereço:</label>
                        <input type="text" id="endereco" name="endereco" value="<?php echo $funcionario['endereco']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="data_admissao">Data de Admissão:</label>
                        <input type="text" id="data_admissao" name="data_admissao" placeholder="Selecione a data" value="<?php echo $funcionario['data_admissao']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="nivel_acesso">Nível de Acesso:</label>
                        <select id="nivel_acesso" name="nivel_acesso" required>
                            <option value="Administrador" <?php echo $funcionario['nivel_acesso'] === 'Administrador' ? 'selected' : ''; ?>>Administrador</option>
                            <option value="Médico" <?php echo $funcionario['nivel_acesso'] === 'Médico' ? 'selected' : ''; ?>>Médico</option>
                            <option value="Funcionário" <?php echo $funcionario['nivel_acesso'] === 'Funcionário' ? 'selected' : ''; ?>>Funcionário</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="cargo">Cargo:</label>
                        <input type="text" id="cargo" name="cargo" value="<?php echo $funcionario['cargo']; ?>" required>
                    </div>

                    <div class="form-group">
                        <label for="especialidade">Especialidade:</label>
                        <input type="text" id="especialidade" name="especialidade" value="<?php echo $funcionario['especialidade']; ?>">
                    </div>

                    <div class="form-group">
                        <label for="inicio_turno">Início do Turno:</label>
                        <input type="time" id="inicio_turno" name="inicio_turno" value="<?php echo $funcionario['inicio_turno']; ?>">
                    </div>

                    <div class="form-group">
                        <label for="fim_turno">Fim do Turno:</label>
                        <input type="time" id="fim_turno" name="fim_turno" value="<?php echo $funcionario['fim_turno']; ?>">
                    </div>

                    <!-- Campo Estado -->
                    <div class="form-group">
                        <label for="estado">Estado:</label>
                        <select id="estado" name="estado" required>
                            <option value="Ativo" <?php echo $funcionario['estado'] === 'Ativo' ? 'selected' : ''; ?>>Ativo</option>
                            <option value="Inativo" <?php echo $funcionario['estado'] === 'Inativo' ? 'selected' : ''; ?>>Inativo</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="senha">Nova Senha (deixe em branco para manter a atual):</label>
                        <input type="password" id="senha" name="senha">
                    </div>

                    <button type="submit" class="btn-atualizar">Atualizar Funcionário</button>
                </form>

                <?php if (isset($mensagem_erro)): ?>
                    <p class="mensagem-erro"><?php echo $mensagem_erro; ?></p>
                <?php endif; ?>
            <?php endif; ?>
        </main>

        <footer>
            <p>Copyright &copy; 2025 Vitalis Clínica</p>
        </footer>
    </div>

    <!-- Scripts do Flatpickr -->
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr/dist/l10n/pt.js"></script>
    <script src="../JS/editar_funcionario.js"></script>

</body>
</html>